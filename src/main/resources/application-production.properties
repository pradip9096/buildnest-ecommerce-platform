# Production profile overrides (PERFORMANCE_OPTIMIZATION_GUIDE - All sections)

# SSL/TLS Configuration
server.ssl.enabled=true
# keystore settings should be provided via environment variables
server.ssl.key-store=${SERVER_SSL_KEY_STORE:}
server.ssl.key-store-password=${SERVER_SSL_KEY_STORE_PASSWORD:}
server.ssl.key-store-type=PKCS12

# HTTP/2 Support for better performance
server.http2.enabled=true
server.compression.enabled=true
server.compression.min-response-size=1024

# JVM Performance Tuning (PERFORMANCE_OPTIMIZATION_GUIDE - JVM Tuning)
# GC Configuration: G1GC with 200ms max pause
# Set via environment: -Xms1g -Xmx2g -XX:+UseG1GC -XX:MaxGCPauseMillis=200

# Logging Configuration - Enable GC logs in production
logging.level.root=WARN
logging.level.com.example.buildnest_ecommerce=INFO

# Enable Logstash appender in production
spring.profiles.include=logstash

# Logstash endpoint (override via environment variables)
# Use LOGSTASH_HOST and LOGSTASH_PORT environment variables (logback-spring.xml reads them)

# Database Connection Pool - Production Tuning (PERFORMANCE_OPTIMIZATION_GUIDE)
spring.datasource.hikari.maximum-pool-size=${DB_POOL_MAX_SIZE:30}
spring.datasource.hikari.minimum-idle=${DB_POOL_MIN_IDLE:15}

# Redis Configuration - Production Tuning
spring.data.redis.jedis.pool.max-active=${REDIS_POOL_MAX_ACTIVE:32}
spring.data.redis.jedis.pool.max-idle=${REDIS_POOL_MAX_IDLE:16}
spring.data.redis.jedis.pool.min-idle=${REDIS_POOL_MIN_IDLE:8}

# Cache TTL - Production settings
spring.cache.redis.time-to-live=${CACHE_TTL:3600000}
cache.ttl.products=1800000
cache.ttl.categories=3600000
cache.ttl.users=3600000
cache.ttl.orders=900000
cache.ttl.rate-limit-stats=60000

# Actuator Configuration (PERFORMANCE_OPTIMIZATION_GUIDE - Monitoring & Metrics)
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=when-authorized
management.endpoint.health.probes.enabled=true
management.health.livenessstate.enabled=true
management.health.readinessstate.enabled=true
management.endpoints.web.base-path=/actuator

# Prometheus Metrics (PERFORMANCE_OPTIMIZATION_GUIDE - Section 7)
management.prometheus.metrics.export.enabled=true
management.metrics.distribution.percentiles-histogram.http.server.requests=true

# Rate Limiting - Production settings (stricter)
rate.limit.login.requests=${RATE_LIMIT_LOGIN_REQUESTS:3}
rate.limit.login.duration=${RATE_LIMIT_LOGIN_DURATION:300}
rate.limit.product-search.requests=${RATE_LIMIT_PRODUCT_SEARCH_REQUESTS:50}
rate.limit.product-search.duration=${RATE_LIMIT_PRODUCT_SEARCH_DURATION:60}

# JPA Configuration for production
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.use_sql_comments=true
spring.jpa.open-in-view=false

# Slow Query Logging (PERFORMANCE_OPTIMIZATION_GUIDE - Database Optimization)
spring.jpa.properties.hibernate.generate_statistics=true
spring.jpa.properties.hibernate.session.events.log=false
